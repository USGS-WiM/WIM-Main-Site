<!-- Footer -->
<div class="wim-footer">
    <div class="standard-width xs-p-15 sm-p-20 md-p-30 lg-p-50">
        <div class="footer-content">
            <h3>Web Informatics & Mapping</h3>
            <h5>USGS Wisconsin Water Science Center</h5>
			<h5>8505 Research Way, Middleton WI 53562</h5>
        </div>
    </div>
</div>

<footer class="usgs-footer">
    <div class="tmp-container">
        <div class="footer-doi">
            <a href="https://www.doi.gov/privacy">DOI Privacy Policy</a>|
            <a href="https://www.usgs.gov/laws/policies_notices.html">Legal</a>|
            <a href="https://www2.usgs.gov/laws/accessibility.html">Accessibility</a>|
            <a href="https://www.usgs.gov/sitemap.html">Site Map</a>|
            <a href="https://answers.usgs.gov/">Contact USGS</a>
        </div>

        <hr>

        <div class="footer-doi">
            <a href="https://www.doi.gov/">U.S. Department of the Interior</a>|
            <a href="https://www.doioig.gov/">DOI Inspector General</a>|
            <a href="https://www.whitehouse.gov/">White House</a>|
            <a href="https://www.whitehouse.gov/omb/e-gov/">E-gov</a>|
            <a href="https://www.whitehouse.gov/open">Open Government</a>|
            <a href="https://www.doi.gov/pmb/eeo/no-fear-act">No Fear Act</a>|
            <a href="https://www2.usgs.gov/foia">FOIA</a>
        </div>    
    </div>
    <!-- /.footer-wrap -->
</footer>


<div class="install-pwa xs-f-around" onclick="installPWA()">
	<span class="pwa-banner-text xs-f-center xs-f-col">Install this webapp to use offline</span> 
	<b class="pwa-banner-button xs-f-center xs-f-col">
		<span>
			<i class="far fa-cloud-download-alt"></i> Install
		</span>
	</b>
</div>


<script>
// ===================================================== //
// ===================================================== //
//            Progressive Webapp Stuff                   //
//            Progressive Webapp Stuff                   //
// ===================================================== //
// ===================================================== //

// Register Service worker on home page for PWA
// Register Service worker on home page for PWA
if ("serviceWorker" in navigator) {
	if (navigator.serviceWorker.controller) {
		console.log("Active service worker found, no need to register");
	} else {
		// Register the service worker
		navigator.serviceWorker
		.register("sw.js", {
			scope: "./"
		})
		.then(function (reg) {
			console.log("Service worker has been registered for scope: " + reg.scope);
		});
	}
}

// Defer prompt for webapp install until called
let deferredPrompt = null;

window.addEventListener('beforeinstallprompt', (e) => {
	// Prevent Chrome 67 and earlier from automatically showing the prompt
	e.preventDefault();
	// Stash the event so it can be triggered later.
	deferredPrompt = e;
});

async function installPWA() {
	if (deferredPrompt) {

		// Show banner if available
		$(".install-pwa").show();
		
		deferredPrompt.prompt();
		console.log(deferredPrompt)
		deferredPrompt.userChoice.then(function(choiceResult){

			if (choiceResult.outcome === 'accepted') {
				console.log('WIM PWA has been installed');
			} else {
				console.log('User chose to not install WIM PWA');
			}

			deferredPrompt = null;

		});


	}
}
</script>